[gd_resource type="ShaderMaterial" load_steps=2 format=2]

[sub_resource type="Shader" id=1]
code = "shader_type spatial;

uniform vec2 uCenter;
uniform float uRadius;
uniform float uOffsetFactor;
uniform float uHeight;

varying float y;

uniform sampler2D textureColor;
uniform sampler2D gameObjects;

void vertex(){
	VERTEX.y += clamp((clamp(distance(VERTEX.xz, uCenter), 0.0, uRadius) / uRadius) * uOffsetFactor, uOffsetFactor * 0.5, uOffsetFactor) - uOffsetFactor;
	y = VERTEX.y;
}

void fragment(){
	ALBEDO = texture(textureColor, UV).xyz;
	if(y<uHeight){
		ALPHA = 0f;
	}else{
		ALPHA = 0.1f;
	}
}
"

[resource]
shader = SubResource( 1 )
